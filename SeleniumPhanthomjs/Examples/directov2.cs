using HtmlAgilityPack;
using OpenQA.Selenium;
using OpenQA.Selenium.PhantomJS;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SeleniumPhanthomjs
{
    public class directov2
    {


        public static int main()
        {

            //var driverService = PhantomJSDriverService.CreateDefaultService(AppDomain.CurrentDomain.BaseDirectory);
            //driverService.HideCommandPromptWindow = true;
            //driverService.LoadImages = false;

            //var options = new PhantomJSOptions();
            //options.AddAdditionalCapability("IsJavaScriptEnabled", true);

            //options.AddAdditionalCapability("phantomjs.page.settings.userAgent", "Mozilla / 5.0(Windows NT 6.1) AppleWebKit / 537.36(KHTML, like Gecko) Chrome / 40.0.2214.94 Safari / 537.36");

            //IWebDriver _driver = new PhantomJSDriver(driverService, options);
            //_driver.Manage().Window.Size = new System.Drawing.Size(1280, 1024);

            //string _baseUrl = @"http://datos.gob.cl/dataset/indices-y-precios-para-el-calculo-del-reajuste-polinomico-ano-2017/resource/2e20f930-6e71-409f-8d17-b8d4202090b7/view/8ed64e98-b346-46a8-9987-e998f8eef5e7";


            //_driver.Navigate().GoToUrl(_baseUrl);

            //string _finalUrl =  _driver.PageSource.ToString();



            var html = new HtmlDocument();

            string row1 = @"<div class='grid-canvas' style='width: 1067px; height: 875px;'><div class='ui-widget-content slick-row  even' row='0' style='top:0px'><div class='slick-cell l0 r0'>1</div><div class='slick-cell l1 r1'>1</div><div class='slick-cell l2 r2'>Índice de precios al consumidor (1)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>116.29</div></div><div class='ui-widget-content slick-row  odd' row='1' style='top:25px'><div class='slick-cell l0 r0'>2</div><div class='slick-cell l1 r1'>2</div><div class='slick-cell l2 r2'>Índice de remuneraciones (2)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>3923.78</div></div><div class='ui-widget-content slick-row  even' row='2' style='top:50px'><div class='slick-cell l0 r0'>3</div><div class='slick-cell l1 r1'>Precios (3)</div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='3' style='top:75px'><div class='slick-cell l0 r0'>4</div><div class='slick-cell l1 r1'>ITEM</div><div class='slick-cell l2 r2'>D E T A L L E</div><div class='slick-cell l3 r3'>UNIDAD</div><div class='slick-cell l4 r4'>VALOR ($)</div></div><div class='ui-widget-content slick-row  even' row='4' style='top:100px'><div class='slick-cell l0 r0'>5</div><div class='slick-cell l1 r1'>3</div><div class='slick-cell l2 r2'>Petróleo Diesel (4)</div><div class='slick-cell l3 r3'>m3</div><div class='slick-cell l4 r4'>414275.097727</div></div><div class='ui-widget-content slick-row  odd' row='5' style='top:125px'><div class='slick-cell l0 r0'>6</div><div class='slick-cell l1 r1'>22</div><div class='slick-cell l2 r2'>Dólar observado</div><div class='slick-cell l3 r3'>$/US$</div><div class='slick-cell l4 r4'>642.41</div></div><div class='ui-widget-content slick-row  even' row='6' style='top:150px'><div class='slick-cell l0 r0'>7</div><div class='slick-cell l1 r1'>24</div><div class='slick-cell l2 r2'>Tubería PVC Ø 75 mm clase 10 (con unión)</div><div class='slick-cell l3 r3'>m</div><div class='slick-cell l4 r4'>2857.0</div></div><div class='ui-widget-content slick-row  odd' row='7' style='top:175px'><div class='slick-cell l0 r0'>8</div><div class='slick-cell l1 r1'>25</div><div class='slick-cell l2 r2'>Tubería PVC Ø 110 mm clase 10 (con unión)</div><div class='slick-cell l3 r3'>m</div><div class='slick-cell l4 r4'>4955.0</div></div><div class='ui-widget-content slick-row  even' row='8' style='top:200px'><div class='slick-cell l0 r0'>9</div><div class='slick-cell l1 r1'>27</div><div class='slick-cell l2 r2'>Petróleo Diesel de refinería CONCÓN</div><div class='slick-cell l3 r3'>m3</div><div class='slick-cell l4 r4'>326827.0</div></div><div class='ui-widget-content slick-row  odd' row='9' style='top:225px'><div class='slick-cell l0 r0'>10</div><div class='slick-cell l1 r1'>28</div><div class='slick-cell l2 r2'>Alambre Cu 12 - AWG 3.31 mm2</div><div class='slick-cell l3 r3'>kg</div><div class='slick-cell l4 r4'>7710.0</div></div><div class='ui-widget-content slick-row  even' row='10' style='top:250px'><div class='slick-cell l0 r0'>11</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='11' style='top:275px'><div class='slick-cell l0 r0'>12</div><div class='slick-cell l1 r1'>Indices  IPP de Industria manufacturera (base 2014=100) (5)</div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='12' style='top:300px'><div class='slick-cell l0 r0'>13</div><div class='slick-cell l1 r1'>ITEM</div><div class='slick-cell l2 r2'>D E T A L L E</div><div class='slick-cell l3 r3'>UNIDAD</div><div class='slick-cell l4 r4'>VALOR</div></div><div class='ui-widget-content slick-row  odd' row='13' style='top:325px'><div class='slick-cell l0 r0'>14</div><div class='slick-cell l1 r1'>36.0</div><div class='slick-cell l2 r2'>Madera de coníferas o de especies no coníferas cepilladas, machimbrada, rebajada o tinglada, sin impregnar</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>105.62</div></div><div class='ui-widget-content slick-row  even' row='14' style='top:350px'><div class='slick-cell l0 r0'>15</div><div class='slick-cell l1 r1'>37.0</div><div class='slick-cell l2 r2'>Barnices y otras pinturas n.c.p. y Pinturas (6)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>103.88</div></div><div class='ui-widget-content slick-row  odd' row='15' style='top:375px'><div class='slick-cell l0 r0'>16</div><div class='slick-cell l1 r1'>38.0</div><div class='slick-cell l2 r2'>Vidrio templado y vidrio pulido o pulimentado, en planchas</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>111.54</div></div><div class='ui-widget-content slick-row  even' row='16' style='top:400px'><div class='slick-cell l0 r0'>17</div><div class='slick-cell l1 r1'>39.0</div><div class='slick-cell l2 r2'>Cemento; excluye refractarios</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>116.98</div></div><div class='ui-widget-content slick-row  odd' row='17' style='top:425px'><div class='slick-cell l0 r0'>18</div><div class='slick-cell l1 r1'>40.0</div><div class='slick-cell l2 r2'>Mezclas bituminosas </div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>85.89</div></div><div class='ui-widget-content slick-row  even' row='18' style='top:450px'><div class='slick-cell l0 r0'>19</div><div class='slick-cell l1 r1'>41.0</div><div class='slick-cell l2 r2'>Manufacturas de hierro o acero no aleado</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>100.58</div></div><div class='ui-widget-content slick-row  odd' row='19' style='top:475px'><div class='slick-cell l0 r0'>20</div><div class='slick-cell l1 r1'>42.0</div><div class='slick-cell l2 r2'>Fabricación de otros productos químicos n.c.p.</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>113.23</div></div><div class='ui-widget-content slick-row  even' row='20' style='top:500px'><div class='slick-cell l0 r0'>21</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='21' style='top:525px'><div class='slick-cell l0 r0'>22</div><div class='slick-cell l1 r1'>Notas:</div><div class='slick-cell l2 r2'> </div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='22' style='top:550px'><div class='slick-cell l0 r0'>23</div><div class='slick-cell l1 r1'>(1)</div><div class='slick-cell l2 r2'>Índice de Precio al Consumidor: Base Anual 2013 = 100. El INE cambió la base del IPC de 2009=100 a 2013 = 100 a partir de enero de 2014. Para calcular el reajuste a partir delnuevo índice, debe utilizarse la publicación del INE: 'Empalme de las Series del IPC, factor de reajustabilidad', en la sección 'Antecedentes Metodológicos' de la dirección web siguiente:</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='23' style='top:575px'><div class='slick-cell l0 r0'>24</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'><a href='http://www.ine.cl/canales/chile_estadistico/estadisticas_precios/ipc/base_2013/index.php'>http://www.ine.cl/canales/chile_estadistico/estadisticas_precios/ipc/base_2013/index.php</a></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='24' style='top:600px'><div class='slick-cell l0 r0'>25</div><div class='slick-cell l1 r1'>(2)</div><div class='slick-cell l2 r2'>El índice de remuneraciones se calcula multiplicando el Indice de Remuneraciones del mes anterior por  el factor resultante de la división del Índice Nominal del Costo de la Mano de Obra por hora (ICMO) de 2 meses atrás  por el ICMO de 3 meses atrás (ambos ICMO de BasesAnual 2009=100),  aplicado con 15 decimales truncado (RES. DP. EXENTA N°218 de 2010).</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='25' style='top:625px'><div class='slick-cell l0 r0'>26</div><div class='slick-cell l1 r1'>(3)</div><div class='slick-cell l2 r2'>Para los antiguos ítem del 4 al 21 (IPM), se deberán utilizar sus equivalentes (IPP) según Resoluciones exentas N° 010 del 14-01-2014  y N° 361 del 28-04-2017 de la Dirección de Planeamiento </div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='26' style='top:650px'><div class='slick-cell l0 r0'>27</div><div class='slick-cell l1 r1'>(4)</div><div class='slick-cell l2 r2'>El valor del petróleo Diesel (Item 3) incluye el impuesto específico. Se calcula multiplicando el valor de Diciembre de 2011 (sin impuesto específico)  por la variación entre Diciembre de 2011 y el mes informado, del petróleo Diesel de refinería de Concón (item 27) y sumándole el impuesto específico (Resol DP 140 de 03-04-2014). El Petróleo  Diesel de Refinería de Concón (Item 27) no  incluye impuesto específico. Impuesto Específico Petróleo Diesel = 1.5 UTM/m3.</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='27' style='top:675px'><div class='slick-cell l0 r0'>28</div><div class='slick-cell l1 r1'>(5)</div><div class='slick-cell l2 r2'>Los Valores de índices IPP se publican sólo despues de ser publicados por el INE, aproximadamente los días 24 de cada mes.</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='28' style='top:700px'><div class='slick-cell l0 r0'>29</div><div class='slick-cell l1 r1'>(6)</div><div class='slick-cell l2 r2'>Valores productos INE 3511003 y 3511009 ponderados por 0,06257 y 0,93743 respectivamente</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='29' style='top:725px'><div class='slick-cell l0 r0'>30</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='30' style='top:750px'><div class='slick-cell l0 r0'>31</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>Valor UF al último día del mes informado  = </div><div class='slick-cell l3 r3'>26731.12</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='31' style='top:775px'><div class='slick-cell l0 r0'>32</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>Valor UTM  mes informado</div><div class='slick-cell l3 r3'>46692.0</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='32' style='top:800px'><div class='slick-cell l0 r0'>33</div><div class='slick-cell l1 r1'>Fuentes:</div><div class='slick-cell l2 r2'>1 , 2 y  36 al 42:    INE </div><div class='slick-cell l3 r3'>22          :   BANCO CENTRAL  </div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='33' style='top:825px'><div class='slick-cell l0 r0'>34</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>24-25   : DURATEC-VINILIT </div><div class='slick-cell l3 r3'> 27          : ENAP</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='34' style='top:850px'><div class='slick-cell l0 r0'>35</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>28         : NEXANS (MADECO)</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div></div>";

            string row2 = @"<div class='slick-viewport' style='width: 100%; overflow: auto; outline: 0px; position: relative; height: 574px;'><div class='grid-canvas' style='width: 1067px; height: 875px;'><div class='ui-widget-content slick-row  even' row='0' style='top:0px'><div class='slick-cell l0 r0'>1</div><div class='slick-cell l1 r1'>1</div><div class='slick-cell l2 r2'>Índice de precios al consumidor (1)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>116.29</div></div><div class='ui-widget-content slick-row  odd' row='1' style='top:25px'><div class='slick-cell l0 r0'>2</div><div class='slick-cell l1 r1'>2</div><div class='slick-cell l2 r2'>Índice de remuneraciones (2)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>3923.78</div></div><div class='ui-widget-content slick-row  even' row='2' style='top:50px'><div class='slick-cell l0 r0'>3</div><div class='slick-cell l1 r1'>Precios (3)</div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='3' style='top:75px'><div class='slick-cell l0 r0'>4</div><div class='slick-cell l1 r1'>ITEM</div><div class='slick-cell l2 r2'>D E T A L L E</div><div class='slick-cell l3 r3'>UNIDAD</div><div class='slick-cell l4 r4'>VALOR ($)</div></div><div class='ui-widget-content slick-row  even' row='4' style='top:100px'><div class='slick-cell l0 r0'>5</div><div class='slick-cell l1 r1'>3</div><div class='slick-cell l2 r2'>Petróleo Diesel (4)</div><div class='slick-cell l3 r3'>m3</div><div class='slick-cell l4 r4'>414275.097727</div></div><div class='ui-widget-content slick-row  odd' row='5' style='top:125px'><div class='slick-cell l0 r0'>6</div><div class='slick-cell l1 r1'>22</div><div class='slick-cell l2 r2'>Dólar observado</div><div class='slick-cell l3 r3'>$/US$</div><div class='slick-cell l4 r4'>642.41</div></div><div class='ui-widget-content slick-row  even' row='6' style='top:150px'><div class='slick-cell l0 r0'>7</div><div class='slick-cell l1 r1'>24</div><div class='slick-cell l2 r2'>Tubería PVC Ø 75 mm clase 10 (con unión)</div><div class='slick-cell l3 r3'>m</div><div class='slick-cell l4 r4'>2857.0</div></div><div class='ui-widget-content slick-row  odd' row='7' style='top:175px'><div class='slick-cell l0 r0'>8</div><div class='slick-cell l1 r1'>25</div><div class='slick-cell l2 r2'>Tubería PVC Ø 110 mm clase 10 (con unión)</div><div class='slick-cell l3 r3'>m</div><div class='slick-cell l4 r4'>4955.0</div></div><div class='ui-widget-content slick-row  even' row='8' style='top:200px'><div class='slick-cell l0 r0'>9</div><div class='slick-cell l1 r1'>27</div><div class='slick-cell l2 r2'>Petróleo Diesel de refinería CONCÓN</div><div class='slick-cell l3 r3'>m3</div><div class='slick-cell l4 r4'>326827.0</div></div><div class='ui-widget-content slick-row  odd' row='9' style='top:225px'><div class='slick-cell l0 r0'>10</div><div class='slick-cell l1 r1'>28</div><div class='slick-cell l2 r2'>Alambre Cu 12 - AWG 3.31 mm2</div><div class='slick-cell l3 r3'>kg</div><div class='slick-cell l4 r4'>7710.0</div></div><div class='ui-widget-content slick-row  even' row='10' style='top:250px'><div class='slick-cell l0 r0'>11</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='11' style='top:275px'><div class='slick-cell l0 r0'>12</div><div class='slick-cell l1 r1'>Indices  IPP de Industria manufacturera (base 2014=100) (5)</div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='12' style='top:300px'><div class='slick-cell l0 r0'>13</div><div class='slick-cell l1 r1'>ITEM</div><div class='slick-cell l2 r2'>D E T A L L E</div><div class='slick-cell l3 r3'>UNIDAD</div><div class='slick-cell l4 r4'>VALOR</div></div><div class='ui-widget-content slick-row  odd' row='13' style='top:325px'><div class='slick-cell l0 r0'>14</div><div class='slick-cell l1 r1'>36.0</div><div class='slick-cell l2 r2'>Madera de coníferas o de especies no coníferas cepilladas, machimbrada, rebajada o tinglada, sin impregnar</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>105.62</div></div><div class='ui-widget-content slick-row  even' row='14' style='top:350px'><div class='slick-cell l0 r0'>15</div><div class='slick-cell l1 r1'>37.0</div><div class='slick-cell l2 r2'>Barnices y otras pinturas n.c.p. y Pinturas (6)</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>103.88</div></div><div class='ui-widget-content slick-row  odd' row='15' style='top:375px'><div class='slick-cell l0 r0'>16</div><div class='slick-cell l1 r1'>38.0</div><div class='slick-cell l2 r2'>Vidrio templado y vidrio pulido o pulimentado, en planchas</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>111.54</div></div><div class='ui-widget-content slick-row  even' row='16' style='top:400px'><div class='slick-cell l0 r0'>17</div><div class='slick-cell l1 r1'>39.0</div><div class='slick-cell l2 r2'>Cemento; excluye refractarios</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>116.98</div></div><div class='ui-widget-content slick-row  odd' row='17' style='top:425px'><div class='slick-cell l0 r0'>18</div><div class='slick-cell l1 r1'>40.0</div><div class='slick-cell l2 r2'>Mezclas bituminosas </div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>85.89</div></div><div class='ui-widget-content slick-row  even' row='18' style='top:450px'><div class='slick-cell l0 r0'>19</div><div class='slick-cell l1 r1'>41.0</div><div class='slick-cell l2 r2'>Manufacturas de hierro o acero no aleado</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>100.58</div></div><div class='ui-widget-content slick-row  odd' row='19' style='top:475px'><div class='slick-cell l0 r0'>20</div><div class='slick-cell l1 r1'>42.0</div><div class='slick-cell l2 r2'>Fabricación de otros productos químicos n.c.p.</div><div class='slick-cell l3 r3'>-</div><div class='slick-cell l4 r4'>113.23</div></div><div class='ui-widget-content slick-row  even' row='20' style='top:500px'><div class='slick-cell l0 r0'>21</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='21' style='top:525px'><div class='slick-cell l0 r0'>22</div><div class='slick-cell l1 r1'>Notas:</div><div class='slick-cell l2 r2'> </div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='22' style='top:550px'><div class='slick-cell l0 r0'>23</div><div class='slick-cell l1 r1'>(1)</div><div class='slick-cell l2 r2'>Índice de Precio al Consumidor: Base Anual 2013 = 100. El INE cambió la base del IPC de 2009=100 a 2013 = 100 a partir de enero de 2014. Para calcular el reajuste a partir delnuevo índice, debe utilizarse la publicación del INE: 'Empalme de las Series del IPC, factor de reajustabilidad', en la sección 'Antecedentes Metodológicos' de la dirección web siguiente:</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='23' style='top:575px'><div class='slick-cell l0 r0'>24</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'><a href='http://www.ine.cl/canales/chile_estadistico/estadisticas_precios/ipc/base_2013/index.php'>http://www.ine.cl/canales/chile_estadistico/estadisticas_precios/ipc/base_2013/index.php</a></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='24' style='top:600px'><div class='slick-cell l0 r0'>25</div><div class='slick-cell l1 r1'>(2)</div><div class='slick-cell l2 r2'>El índice de remuneraciones se calcula multiplicando el Indice de Remuneraciones del mes anterior por  el factor resultante de la división del Índice Nominal del Costo de la Mano de Obra por hora (ICMO) de 2 meses atrás  por el ICMO de 3 meses atrás (ambos ICMO de BasesAnual 2009=100),  aplicado con 15 decimales truncado (RES. DP. EXENTA N°218 de 2010).</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='25' style='top:625px'><div class='slick-cell l0 r0'>26</div><div class='slick-cell l1 r1'>(3)</div><div class='slick-cell l2 r2'>Para los antiguos ítem del 4 al 21 (IPM), se deberán utilizar sus equivalentes (IPP) según Resoluciones exentas N° 010 del 14-01-2014  y N° 361 del 28-04-2017 de la Dirección de Planeamiento </div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='26' style='top:650px'><div class='slick-cell l0 r0'>27</div><div class='slick-cell l1 r1'>(4)</div><div class='slick-cell l2 r2'>El valor del petróleo Diesel (Item 3) incluye el impuesto específico. Se calcula multiplicando el valor de Diciembre de 2011 (sin impuesto específico)  por la variación entre Diciembre de 2011 y el mes informado, del petróleo Diesel de refinería de Concón (item 27) y sumándole el impuesto específico (Resol DP 140 de 03-04-2014). El Petróleo  Diesel de Refinería de Concón (Item 27) no  incluye impuesto específico. Impuesto Específico Petróleo Diesel = 1.5 UTM/m3.</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='27' style='top:675px'><div class='slick-cell l0 r0'>28</div><div class='slick-cell l1 r1'>(5)</div><div class='slick-cell l2 r2'>Los Valores de índices IPP se publican sólo despues de ser publicados por el INE, aproximadamente los días 24 de cada mes.</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='28' style='top:700px'><div class='slick-cell l0 r0'>29</div><div class='slick-cell l1 r1'>(6)</div><div class='slick-cell l2 r2'>Valores productos INE 3511003 y 3511009 ponderados por 0,06257 y 0,93743 respectivamente</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='29' style='top:725px'><div class='slick-cell l0 r0'>30</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'></div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='30' style='top:750px'><div class='slick-cell l0 r0'>31</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>Valor UF al último día del mes informado  = </div><div class='slick-cell l3 r3'>26731.12</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='31' style='top:775px'><div class='slick-cell l0 r0'>32</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>Valor UTM  mes informado</div><div class='slick-cell l3 r3'>46692.0</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='32' style='top:800px'><div class='slick-cell l0 r0'>33</div><div class='slick-cell l1 r1'>Fuentes:</div><div class='slick-cell l2 r2'>1 , 2 y  36 al 42:    INE </div><div class='slick-cell l3 r3'>22          :   BANCO CENTRAL  </div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  odd' row='33' style='top:825px'><div class='slick-cell l0 r0'>34</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>24-25   : DURATEC-VINILIT </div><div class='slick-cell l3 r3'> 27          : ENAP</div><div class='slick-cell l4 r4'></div></div><div class='ui-widget-content slick-row  even' row='34' style='top:850px'><div class='slick-cell l0 r0'>35</div><div class='slick-cell l1 r1'></div><div class='slick-cell l2 r2'>28         : NEXANS (MADECO)</div><div class='slick-cell l3 r3'></div><div class='slick-cell l4 r4'></div></div></div></div>";


             //string htmlpage = row1;

            string htmlpage = row2;

            

            html.LoadHtml(htmlpage);


            var parsedTb = html
                          .DocumentNode
                          .Descendants("div")
                          .Where(d =>
                            d.Attributes.Contains("class")
                                &&
                                d.ChildNodes.Count() > 1
                          ).Select(tr => tr.Elements("div")
                                   .Where(p =>
                                          p.Attributes.Contains("class")
                                   )
                                   .Select(td => td.InnerText.Trim())
                                   .ToList())
                          .ToList();
            //-----------------------------------------------------

            //var html2 = html.DocumentNode
            //               .Descendants("div")
            //               .Where(d =>
            //                     d.Attributes.Contains("class")
            //                      &&
            //                     d.Attributes["class"].Value.Contains("grid-canvas")
            //                    );





        var html1 = html.DocumentNode
                               .Descendants("div")
                               .Where(d =>
                                 d.Attributes.Contains("class")
                                 &&
                                 d.Attributes["class"].Value.Contains("grid-canvas")
                                 ).Select(p => p.Descendants(
                                 "div")
                           .Where(d =>
                             d.Attributes.Contains("class")
                             &&
                             d.ChildNodes.Count() > 1
                           ).Select(tr => tr.Elements("div")
                                    .Where(ph =>
                                           ph.Attributes.Contains("class")

                                    )
                                    .Select(td => td.InnerText.Trim())
                                    .ToList())
                           .ToList()


                                 );

            return 1;

        }
    }
}
